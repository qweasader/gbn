# SPDX-FileCopyrightText: 2024 Greenbone AG
# Some text descriptions might be excerpted from (a) referenced
# source(s), and are Copyright (C) by the respective right holder(s).
#
# SPDX-License-Identifier: GPL-2.0-only

if(description)
{
  script_oid("1.3.6.1.4.1.25623.1.0.856360");
  script_version("2024-08-23T05:05:37+0000");
  script_cve_id("CVE-2021-47086", "CVE-2021-47103", "CVE-2021-47186", "CVE-2021-47402", "CVE-2021-47546", "CVE-2021-47547", "CVE-2021-47588", "CVE-2021-47590", "CVE-2021-47591", "CVE-2021-47593", "CVE-2021-47598", "CVE-2021-47599", "CVE-2021-47606", "CVE-2021-47622", "CVE-2021-47623", "CVE-2021-47624", "CVE-2022-48713", "CVE-2022-48730", "CVE-2022-48732", "CVE-2022-48749", "CVE-2022-48756", "CVE-2022-48773", "CVE-2022-48774", "CVE-2022-48775", "CVE-2022-48776", "CVE-2022-48777", "CVE-2022-48778", "CVE-2022-48780", "CVE-2022-48783", "CVE-2022-48784", "CVE-2022-48785", "CVE-2022-48786", "CVE-2022-48787", "CVE-2022-48788", "CVE-2022-48789", "CVE-2022-48790", "CVE-2022-48791", "CVE-2022-48792", "CVE-2022-48793", "CVE-2022-48794", "CVE-2022-48796", "CVE-2022-48797", "CVE-2022-48798", "CVE-2022-48799", "CVE-2022-48800", "CVE-2022-48801", "CVE-2022-48802", "CVE-2022-48803", "CVE-2022-48804", "CVE-2022-48805", "CVE-2022-48806", "CVE-2022-48807", "CVE-2022-48809", "CVE-2022-48810", "CVE-2022-48811", "CVE-2022-48812", "CVE-2022-48813", "CVE-2022-48814", "CVE-2022-48815", "CVE-2022-48816", "CVE-2022-48817", "CVE-2022-48818", "CVE-2022-48820", "CVE-2022-48821", "CVE-2022-48822", "CVE-2022-48823", "CVE-2022-48824", "CVE-2022-48825", "CVE-2022-48826", "CVE-2022-48827", "CVE-2022-48828", "CVE-2022-48829", "CVE-2022-48830", "CVE-2022-48831", "CVE-2022-48834", "CVE-2022-48835", "CVE-2022-48836", "CVE-2022-48837", "CVE-2022-48838", "CVE-2022-48839", "CVE-2022-48840", "CVE-2022-48841", "CVE-2022-48842", "CVE-2022-48843", "CVE-2022-48844", "CVE-2022-48846", "CVE-2022-48847", "CVE-2022-48849", "CVE-2022-48850", "CVE-2022-48851", "CVE-2022-48852", "CVE-2022-48853", "CVE-2022-48855", "CVE-2022-48856", "CVE-2022-48857", "CVE-2022-48858", "CVE-2022-48859", "CVE-2022-48860", "CVE-2022-48861", "CVE-2022-48862", "CVE-2022-48863", "CVE-2022-48864", "CVE-2022-48866", "CVE-2023-1582", "CVE-2023-37453", "CVE-2023-52435", "CVE-2023-52573", "CVE-2023-52580", "CVE-2023-52591", "CVE-2023-52735", "CVE-2023-52751", "CVE-2023-52762", "CVE-2023-52775", "CVE-2023-52812", "CVE-2023-52857", "CVE-2023-52863", "CVE-2023-52885", "CVE-2023-52886", "CVE-2024-25741", "CVE-2024-26583", "CVE-2024-26584", "CVE-2024-26585", "CVE-2024-26615", "CVE-2024-26633", "CVE-2024-26635", "CVE-2024-26636", "CVE-2024-26641", "CVE-2024-26661", "CVE-2024-26663", "CVE-2024-26665", "CVE-2024-26800", "CVE-2024-26802", "CVE-2024-26813", "CVE-2024-26814", "CVE-2024-26863", "CVE-2024-26889", "CVE-2024-26920", "CVE-2024-26935", "CVE-2024-269355", "CVE-2024-26961", "CVE-2024-26976", "CVE-2024-27015", "CVE-2024-27019", "CVE-2024-27020", "CVE-2024-27025", "CVE-2024-27065", "CVE-2024-27402", "CVE-2024-27437", "CVE-2024-35805", "CVE-2024-35819", "CVE-2024-35837", "CVE-2024-35853", "CVE-2024-35854", "CVE-2024-35855", "CVE-2024-35889", "CVE-2024-35890", "CVE-2024-35893", "CVE-2024-35899", "CVE-2024-35934", "CVE-2024-35949", "CVE-2024-35961", "CVE-2024-35979", "CVE-2024-35995", "CVE-2024-36000", "CVE-2024-36004", "CVE-2024-36288", "CVE-2024-36889", "CVE-2024-36901", "CVE-2024-36902", "CVE-2024-36909", "CVE-2024-36910", "CVE-2024-36911", "CVE-2024-36912", "CVE-2024-36913", "CVE-2024-36914", "CVE-2024-36919", "CVE-2024-36923", "CVE-2024-36924", "CVE-2024-36926", "CVE-2024-36939", "CVE-2024-36941", "CVE-2024-36942", "CVE-2024-36944", "CVE-2024-36946", "CVE-2024-36947", "CVE-2024-36950", "CVE-2024-36952", "CVE-2024-36955", "CVE-2024-36959", "CVE-2024-36974", "CVE-2024-38548", "CVE-2024-38555", "CVE-2024-38558", "CVE-2024-38559", "CVE-2024-38570", "CVE-2024-38586", "CVE-2024-38588", "CVE-2024-38598", "CVE-2024-38628", "CVE-2024-39276", "CVE-2024-39371", "CVE-2024-39463", "CVE-2024-39472", "CVE-2024-39475", "CVE-2024-39482", "CVE-2024-39487", "CVE-2024-39488", "CVE-2024-39490", "CVE-2024-39493", "CVE-2024-39494", "CVE-2024-39497", "CVE-2024-39499", "CVE-2024-39500", "CVE-2024-39501", "CVE-2024-39502", "CVE-2024-39505", "CVE-2024-39506", "CVE-2024-39507", "CVE-2024-39508", "CVE-2024-39509", "CVE-2024-40900", "CVE-2024-40901", "CVE-2024-40902", "CVE-2024-40903", "CVE-2024-40904", "CVE-2024-40906", "CVE-2024-40908", "CVE-2024-40909", "CVE-2024-40911", "CVE-2024-40912", "CVE-2024-40916", "CVE-2024-40919", "CVE-2024-40923", "CVE-2024-40924", "CVE-2024-40927", "CVE-2024-40929", "CVE-2024-40931", "CVE-2024-40932", "CVE-2024-40934", "CVE-2024-40935", "CVE-2024-40937", "CVE-2024-40940", "CVE-2024-40941", "CVE-2024-40942", "CVE-2024-40943", "CVE-2024-40945", "CVE-2024-40953", "CVE-2024-40954", "CVE-2024-40956", "CVE-2024-40958", "CVE-2024-40959", "CVE-2024-40960", "CVE-2024-40961", "CVE-2024-40966", "CVE-2024-40967", "CVE-2024-40970", "CVE-2024-40972", "CVE-2024-40976", "CVE-2024-40977", "CVE-2024-40981", "CVE-2024-40982", "CVE-2024-40984", "CVE-2024-40987", "CVE-2024-40988", "CVE-2024-40989", "CVE-2024-40990", "CVE-2024-40994", "CVE-2024-40998", "CVE-2024-40999", "CVE-2024-41002", "CVE-2024-41004", "CVE-2024-41006", "CVE-2024-41009", "CVE-2024-41011", "CVE-2024-41012", "CVE-2024-41013", "CVE-2024-41014", "CVE-2024-41015", "CVE-2024-41016", "CVE-2024-41017", "CVE-2024-41040", "CVE-2024-41041", "CVE-2024-41044", "CVE-2024-41048", "CVE-2024-41057", "CVE-2024-41058", "CVE-2024-41059", "CVE-2024-41063", "CVE-2024-41064", "CVE-2024-41066", "CVE-2024-41069", "CVE-2024-41070", "CVE-2024-41071", "CVE-2024-41072", "CVE-2024-41076", "CVE-2024-41078", "CVE-2024-41081", "CVE-2024-41087", "CVE-2024-41090", "CVE-2024-41091", "CVE-2024-42070", "CVE-2024-42079", "CVE-2024-42093", "CVE-2024-42096", "CVE-2024-42105", "CVE-2024-42122", "CVE-2024-42124", "CVE-2024-42145", "CVE-2024-42161", "CVE-2024-42224", "CVE-2024-42230");
  script_tag(name:"cvss_base", value:"6.8");
  script_tag(name:"cvss_base_vector", value:"AV:L/AC:L/Au:S/C:C/I:C/A:C");
  script_tag(name:"last_modification", value:"2024-08-23 05:05:37 +0000 (Fri, 23 Aug 2024)");
  script_tag(name:"severity_vector", value:"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_tag(name:"severity_origin", value:"NVD");
  script_tag(name:"severity_date", value:"2024-08-02 14:24:16 +0000 (Fri, 02 Aug 2024)");
  script_tag(name:"creation_date", value:"2024-08-20 04:00:57 +0000 (Tue, 20 Aug 2024)");
  script_name("openSUSE: Security Advisory for the Linux Kernel (SUSE-SU-2024:2947-1)");
  script_category(ACT_GATHER_INFO);
  script_copyright("Copyright (C) 2024 Greenbone AG");
  script_family("SuSE Local Security Checks");
  script_dependencies("gather-package-list.nasl");
  script_mandatory_keys("ssh/login/suse", "ssh/login/rpms", re:"ssh/login/release=openSUSELeap15\.5");

  script_xref(name:"Advisory-ID", value:"SUSE-SU-2024:2947-1");
  script_xref(name:"URL", value:"https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/HSKQ2J4HDKZZQSR7N5VL2NVGE6X33UCY");

  script_tag(name:"summary", value:"The remote host is missing an update for the 'the Linux Kernel'
  package(s) announced via the SUSE-SU-2024:2947-1 advisory.");

  script_tag(name:"vuldetect", value:"Checks if a vulnerable package version is present on the target host.");

  script_tag(name:"insight", value:"The SUSE Linux Enterprise 15 SP5 Azure kernel was updated to receive various
  security bugfixes.

  The following security bugs were fixed:

  * CVE-2021-47086: phonet/pep: refuse to enable an unbound pipe (bsc#1220952).

  * CVE-2021-47103: net: sock: preserve kabi for sock (bsc#1221010).

  * CVE-2021-47186: ipc: check for null after calling kmemdup (bsc#1222702).

  * CVE-2021-47546: Kabi fix for ipv6: fix memory leak in fib6_rule_suppress
      (bsc#1225504).

  * CVE-2021-47547: net: tulip: de4x5: fix the problem that the array 'lp->phy'
      may be out of bound (bsc#1225505).

  * CVE-2021-47588: sit: do not call ipip6_dev_free() from sit_init_net()
      (bsc#1226568).

  * CVE-2021-47590: mptcp: fix deadlock in __mptcp_push_pending() (bsc#1226565).

  * CVE-2021-47591: mptcp: remove tcp ulp setsockopt support (bsc#1226570).

  * CVE-2021-47593: mptcp: clear 'kern' flag from fallback sockets
      (bsc#1226551).

  * CVE-2021-47598: sch_cake: do not call cake_destroy() from cake_init()
      (bsc#1226574).

  * CVE-2021-47599: btrfs: use latest_dev in btrfs_show_devname (bsc#1226571)

  * CVE-2021-47606: net: netlink: af_netlink: Prevent empty skb by adding a
      check on len (bsc#1226555).

  * CVE-2021-47623: powerpc/fixmap: Fix VM debug warning on unmap (bsc#1227919).

  * CVE-2022-48785: ipv6: mcast: use rcu-safe version of ipv6_get_lladdr()
      (bsc#1227927)

  * CVE-2022-48810: ipmr,ip6mr: acquire RTNL before calling ip[6]mr_free_table()
      on failure path (bsc#1227936).

  * CVE-2022-48850: net-sysfs: add check for netdevice being present to
      speed_show (bsc#1228071)

  * CVE-2022-48855: sctp: fix kernel-infoleak for SCTP sockets (bsc#1228003).

  * CVE-2023-52435: net: prevent mss overflow in skb_segment() (bsc#1220138).

  * CVE-2023-52573: net: rds: Fix possible NULL-pointer dereference
      (bsc#1220869)

  * CVE-2023-52580: net/core: Fix ETH_P_1588 flow dissector (bsc#1220876).

  * CVE-2023-52751: smb: client: fix use-after-free in
      smb2_query_info_compound() (bsc#1225489).

  * CVE-2023-52775: net/smc: avoid data corruption caused by decline
      (bsc#1225088).

  * CVE-2023-52812: drm/amd: check num of link levels when update pcie param
      (bsc#1225564).

  * CVE-2023-52857: drm/mediatek: Fix coverity issue with unintentional integer
      overflow (bsc#1225581).

  * CVE-2023-52863: hwmon: (axi-fan-control) Fix possible NULL pointer
      dereference (bsc#1225586).

  * CVE-2024-26585: Fixed race between tx work scheduling and socket close
      (bsc#1220187).

  * CVE-2024-26615: net/smc: fix illega ...

  Description truncated. Please see the references for more information.");

  script_tag(name:"affected", value:"'the Linux Kernel' package(s) on openSUSE Leap 15.5.");

  script_tag(name:"solution", value:"Please install the updated package(s).");

  script_tag(name:"solution_type", value:"VendorFix");
  script_tag(name:"qod_type", value:"package");

  exit(0);
}

include("revisions-lib.inc");
include("pkg-lib-rpm.inc");

release = rpm_get_ssh_release();
if(!release)
  exit(0);

res = "";
report = "";

if(release == "openSUSELeap15.5") {

  if(!isnull(res = isrpmvuln(pkg:"cluster-md-kmp-azure", rpm:"cluster-md-kmp-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"ocfs2-kmp-azure-debuginfo", rpm:"ocfs2-kmp-azure-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"gfs2-kmp-azure", rpm:"gfs2-kmp-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-optional-debuginfo", rpm:"kernel-azure-optional-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"ocfs2-kmp-azure", rpm:"ocfs2-kmp-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-devel", rpm:"kernel-azure-devel~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"reiserfs-kmp-azure-debuginfo", rpm:"reiserfs-kmp-azure-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"reiserfs-kmp-azure", rpm:"reiserfs-kmp-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"dlm-kmp-azure", rpm:"dlm-kmp-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-extra-debuginfo", rpm:"kernel-azure-extra-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"cluster-md-kmp-azure-debuginfo", rpm:"cluster-md-kmp-azure-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kselftests-kmp-azure-debuginfo", rpm:"kselftests-kmp-azure-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"dlm-kmp-azure-debuginfo", rpm:"dlm-kmp-azure-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-devel-debuginfo", rpm:"kernel-azure-devel-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kselftests-kmp-azure", rpm:"kselftests-kmp-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-optional", rpm:"kernel-azure-optional~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-extra", rpm:"kernel-azure-extra~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-debuginfo", rpm:"kernel-azure-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-debugsource", rpm:"kernel-azure-debugsource~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-syms-azure", rpm:"kernel-syms-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"gfs2-kmp-azure-debuginfo", rpm:"gfs2-kmp-azure-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-livepatch-devel", rpm:"kernel-azure-livepatch-devel~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure", rpm:"kernel-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-vdso-debuginfo", rpm:"kernel-azure-vdso-debuginfo~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-azure-vdso", rpm:"kernel-azure-vdso~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-source-azure", rpm:"kernel-source-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-devel-azure", rpm:"kernel-devel-azure~5.14.21~150500.33.63.1", rls:"openSUSELeap15.5"))) {
    report += res;
  }

  if(report != "") {
    security_message(data:report);
  } else if(__pkg_match) {
    exit(99);
  }
  exit(0);
}

exit(0);